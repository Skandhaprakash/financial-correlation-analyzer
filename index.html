
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Correlation Analyzer - Investmentor</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Financial Correlation Analyzer</h1>
            <p>5-Year Financial Health & Investor Readiness Assessment</p>
        </header>

        <div class="main-content">
            <section class="input-section">
                <h2>Search & Analyze</h2>
                <div class="search-box">
                    <input 
                        type="text" 
                        id="tickerInput" 
                        placeholder="Enter ticker symbol (e.g., MSFT, AAPL, TCS, RELIANCE)"
                        class="ticker-input"
                    >
                    <button onclick="searchTicker()" class="btn-primary">Analyze</button>
                    <span class="loading" id="loading" style="display:none;">Loading...</span>
                </div>
                <div id="errorMessage" class="error-message" style="display:none;"></div>
            </section>

            <section class="results-section" id="resultsSection" style="display:none;">
                <div class="company-info">
                    <h2 id="companyName"></h2>
                    <p id="companyPeriod"></p>
                </div>

                <!-- Tabs Navigation -->
                <div class="tabs">
                    <button class="tab-button active" onclick="switchTab('metrics')">Derived Metrics</button>
                    <button class="tab-button" onclick="switchTab('anomalies')">Anomaly Flags</button>
                    <button class="tab-button" onclick="switchTab('bridge')">Variance Bridge</button>
                    <button class="tab-button" onclick="switchTab('ir-notes')">Investor Notes</button>
                    <button class="tab-button" onclick="downloadExcel()">ðŸ“¥ Export Excel</button>
                </div>

                <!-- Tab Contents -->
                <div class="tab-content">
                    <!-- Metrics Tab -->
                    <div id="metrics" class="tab-pane active">
                        <h3>Key Financial Metrics</h3>
                        <div class="metrics-grid" id="metricsGrid"></div>
                        <canvas id="metricsChart" style="margin-top:30px;"></canvas>
                    </div>

                    <!-- Anomalies Tab -->
                    <div id="anomalies" class="tab-pane" style="display:none;">
                        <h3>Financial Anomalies Detected</h3>
                        <div class="anomalies-list" id="anomaliesList"></div>
                    </div>

                    <!-- Bridge Tab -->
                    <div id="bridge" class="tab-pane" style="display:none;">
                        <h3>YoY Variance Analysis</h3>
                        <canvas id="varianceChart"></canvas>
                        <div class="variance-insights" id="varianceInsights" style="margin-top:30px;"></div>
                    </div>

                    <!-- IR Notes Tab -->
                    <div id="ir-notes" class="tab-pane" style="display:none;">
                        <h3>Investor Relations Summary</h3>
                        <div class="ir-notes" id="irNotes"></div>
                    </div>
                </div>
            </section>
        </div>

        <footer>
            <p>Investmentor | Financial Analysis Platform | Data powered by yfinance</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>5-Year Financial Correlation Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="light">
  <header class="app-header">
    <h1>5-Year Financial Correlation Dashboard</h1>
    <div class="header-controls">
      <div class="ticker-input">
        <label for="ticker">Enter Ticker Symbol</label>
        <input type="text" id="ticker" value="NEWGEN" />
        <button id="searchBtn">Search</button>
      </div>
      <div class="mode-toggle">
        <span>Dark Mode</span>
        <label class="switch">
          <input type="checkbox" id="modeToggle" />
          <span class="slider round"></span>
        </label>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="table-section">
      <h2>Input Financials (FY21â€“FY25)</h2>
      <div class="table-wrapper">
        <table id="financialTable">
          <thead>
            <tr>
              <th>Year</th>
              <th>Revenue</th>
              <th>EBITDA</th>
              <th>Net Profit (PAT)</th>
              <th>Operating Cash Flow (OCF)</th>
              <th>Free Cash Flow (FCF)</th>
              <th>Accounts Receivable (AR)</th>
              <th>Cash Balance</th>
              <th>Equity</th>
              <th>Debt</th>
              <th>Investments/Advances</th>
              <th>Dividends Paid</th>
              <th>Inventory</th>
              <th>Trade Payables</th>
            </tr>
          </thead>
          <tbody>
            <tr data-year="2021">
              <td>FY21</td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
            </tr>
            <tr data-year="2022">
              <td>FY22</td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
            </tr>
            <tr data-year="2023">
              <td>FY23</td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
            </tr>
            <tr data-year="2024">
              <td>FY24</td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
            </tr>
            <tr data-year="2025">
              <td>FY25</td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="action-buttons">
        <button id="calcBtn">Calculate Metrics</button>
        <button id="anomalyBtn">Show Anomalies</button>
        <button id="chartBtn">Generate Charts</button>
        <button id="exportCsvBtn">Export CSV</button>
        <button id="exportPdfBtn">Export PDF</button>
      </div>
    </section>

    <section class="metrics-section">
      <h2>Derived Metrics</h2>
      <div class="table-wrapper">
        <table id="metricsTable">
          <thead>
            <tr>
              <th>Year</th>
              <th>EBITDA Margin</th>
              <th>PAT Margin</th>
              <th>Cash Conversion (OCF/EBITDA)</th>
              <th>DSO (days)</th>
              <th>Equity Growth YoY</th>
              <th>Cash/Equity Ratio</th>
              <th>Revenue YoY %</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section class="metrics-section">
      <h2>Anomalies & Interpretations</h2>
      <div class="table-wrapper">
        <table id="anomalyTable">
          <thead>
            <tr>
              <th>Year</th>
              <th>Flag</th>
              <th>Condition</th>
              <th>Interpretation</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="legend">
        <span class="badge red">Red = High Risk</span>
        <span class="badge orange">Orange = Medium Risk</span>
        <span class="badge yellow">Yellow = Mild Concern</span>
        <span class="badge blue">Blue = Positive Outlier</span>
        <span class="badge purple">Purple = Structural Shift</span>
      </div>
    </section>

    <section class="charts-section">
      <h2>Charts</h2>
      <div class="charts-grid">
        <div class="chart-card">
          <canvas id="waterfallChart"></canvas>
          <p class="chart-caption" id="waterfallCaption"></p>
        </div>
        <div class="chart-card">
          <canvas id="revOcfChart"></canvas>
          <p class="chart-caption" id="revOcfCaption"></p>
        </div>
        <div class="chart-card">
          <canvas id="equityCashChart"></canvas>
          <p class="chart-caption" id="equityCashCaption"></p>
        </div>
        <div class="chart-card">
          <canvas id="dsoChart"></canvas>
          <p class="chart-caption" id="dsoCaption"></p>
        </div>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <small>All calculations are indicative and for analysis only.</small>
  </footer>

  <script src="script.js"></script>
</body>
</html>
